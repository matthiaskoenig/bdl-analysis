main=method,
density.info="none", dendrogram="column", Rowv=as.dendrogram(hc), Colv=as.dendrogram(hc), keysize=0.8,
ColSideColors=clusterColors, revC=TRUE)
heatmap.2(cor.cluster, col=col2(20), scale="none",
key=TRUE, symkey=FALSE, trace="none", cexRow=0.5, cexCol=0.5,
main=method,
density.info="none", dendrogram="column", Rowv=as.dendrogram(hc), Colv=as.dendrogram(hc), keysize=0.8,
ColSideColors=clusterColors, revC=TRUE)
method <- 'ys3'
cor.cluster <- correlation_matrix_for_method(method)
col2 <- HeatmapColors()
hc <- hclust(dist(cor.cluster))
# get cluster IDs for the groups
groups <- cutree(hc, k=Ngroups)
# define colors for the Ngroups clusters
# display.brewer.all()
colorset <- brewer.pal(Ngroups, "Set1")
color.map <- function(cluster_id) {return(colorset[cluster_id])}
clusterColors <- unlist(lapply(groups, color.map))
heatmap.2(cor.cluster, col=col2(10), scale="none",
key=TRUE, symkey=FALSE, trace="none", cexRow=0.5, cexCol=0.5,
main=method,
density.info="none", dendrogram="column", Rowv=as.dendrogram(hc), Colv=as.dendrogram(hc), keysize=0.8,
ColSideColors=clusterColors, revC=TRUE)
23290*2871
(23290*2871)/21000
(23000*2871)/21000
21000*3144
262-175
87/3
heatmap.2(cor.cluster, col=col2(10), scale="none",
key=TRUE, symkey=FALSE, trace="none", cexRow=0.5, cexCol=0.5,
main=method,
density.info="none", dendrogram="column", Rowv=as.dendrogram(hc), Colv=as.dendrogram(hc), keysize=0.8,
ColSideColors=clusterColors, revC=TRUE,
sepwidth=c(0.1,0.1),
sepcolor="gray",
colsep=1:ncol(cor.cluster),
rowsep=1:nrow(cor.cluster))
heatmap.2(cor.cluster, col=col2(10), scale="none",
key=TRUE, symkey=FALSE, trace="none", cexRow=0.5, cexCol=0.5,
main=method,
density.info="none", dendrogram="column", Rowv=as.dendrogram(hc), Colv=as.dendrogram(hc), keysize=0.8,
ColSideColors=clusterColors, revC=TRUE,
sepwidth=c(0.05,0.05),
sepcolor="gray",
colsep=1:ncol(cor.cluster),
rowsep=1:nrow(cor.cluster))
plot_ys3_heatmap <- function(){
heatmap.2(cor.cluster, col=col2(10), scale="none",
key=TRUE, symkey=FALSE, trace="none", cexRow=0.5, cexCol=0.5,
main=method,
density.info="none", dendrogram="column", Rowv=as.dendrogram(hc), Colv=as.dendrogram(hc), keysize=0.8,
ColSideColors=clusterColors, revC=TRUE,
sepwidth=c(0.05,0.05),
sepcolor="gray",
colsep=1:ncol(cor.cluster),
rowsep=1:nrow(cor.cluster))
}
method <- 'ys3'
cor.cluster <- correlation_matrix_for_method(method)
col2 <- HeatmapColors()
hc <- hclust(dist(cor.cluster))
# get cluster IDs for the groups
groups <- cutree(hc, k=Ngroups)
# define colors for the Ngroups clusters
colorset <- brewer.pal(Ngroups, "Set1")
color.map <- function(cluster_id) {return(colorset[cluster_id])}
clusterColors <- unlist(lapply(groups, color.map))
# Create heatmap plot
plot_ys3_heatmap <- function(){
heatmap.2(cor.cluster, col=col2(10), scale="none",
key=TRUE, symkey=FALSE, trace="none", cexRow=0.5, cexCol=0.5,
main=method,
density.info="none", dendrogram="column", Rowv=as.dendrogram(hc), Colv=as.dendrogram(hc), keysize=0.8,
ColSideColors=clusterColors, revC=TRUE,
sepwidth=c(0.05,0.05),
sepcolor="gray",
colsep=1:ncol(cor.cluster),
rowsep=1:nrow(cor.cluster))
}
# plot to file
png(filename=file.path(resultsPath, "correlation", "ys3_correlation.png"), width=3000, height=1000, res=300)
plot_ys3_heatmap()
invisible(dev.off())
# plot to report
plot_ys3_heatmap()
png(filename=file.path(resultsPath, "correlation", "ys3_correlation.png"), width=3000, height=3000, res=300)
plot_ys3_heatmap()
invisible(dev.off())
# plot to report
plot_ys3_heatmap()
png(filename=file.path(resultsPath, "correlation", "ys3_correlation.png"), width=2000, height=2000, res=300)
plot_ys3_heatmap()
invisible(dev.off())
png(filename=file.path(resultsPath, "correlation", "ys3_correlation.png"), width=2500, height=2500, res=200)
plot_ys3_heatmap()
invisible(dev.off())
method <- 'ys3'
cor.cluster <- correlation_matrix_for_method(method)
col2 <- HeatmapColors()
hc <- hclust(dist(cor.cluster))
# get cluster IDs for the groups
groups <- cutree(hc, k=Ngroups)
# define colors for the Ngroups clusters
colorset <- brewer.pal(Ngroups, "Set1")
color.map <- function(cluster_id) {return(colorset[cluster_id])}
clusterColors <- unlist(lapply(groups, color.map))
# Create heatmap plot
plot_ys3_heatmap <- function(){
heatmap.2(cor.cluster, col=col2(10), scale="none",
key=TRUE, symkey=FALSE, trace="none", cexRow=0.8, cexCol=0.8,
main=method,
density.info="none", dendrogram="column", Rowv=as.dendrogram(hc), Colv=as.dendrogram(hc), keysize=0.8,
ColSideColors=clusterColors, revC=TRUE,
sepwidth=c(0.05,0.05),
sepcolor="gray",
colsep=1:ncol(cor.cluster),
rowsep=1:nrow(cor.cluster))
}
# plot to file
png(filename=file.path(resultsPath, "correlation", "ys3_correlation.png"), width=2500, height=2500, res=200)
plot_ys3_heatmap()
invisible(dev.off())
# plot to report
plot_ys3_heatmap()
method <- 'ys3'
cor.cluster <- correlation_matrix_for_method(method)
col2 <- HeatmapColors()
hc <- hclust(dist(cor.cluster))
# get cluster IDs for the groups
groups <- cutree(hc, k=Ngroups)
# define colors for the Ngroups clusters
colorset <- brewer.pal(Ngroups, "Set1")
color.map <- function(cluster_id) {return(colorset[cluster_id])}
clusterColors <- unlist(lapply(groups, color.map))
# Create heatmap plot
plot_ys3_heatmap <- function(){
heatmap.2(cor.cluster, col=col2(10), scale="none",
key=TRUE, symkey=FALSE, trace="none", cexRow=0.8, cexCol=0.8,
main=method,
density.info="none", dendrogram="column", Rowv=as.dendrogram(hc), Colv=as.dendrogram(hc), keysize=0.8,
ColSideColors=clusterColors, revC=TRUE,
sepwidth=c(0.05,0.05),
sepcolor="white",
colsep=1:ncol(cor.cluster),
rowsep=1:nrow(cor.cluster))
}
# plot to file
png(filename=file.path(resultsPath, "correlation", "ys3_correlation.png"), width=2500, height=2500, res=200)
plot_ys3_heatmap()
invisible(dev.off())
# plot to report
plot_ys3_heatmap()
method <- 'ys3'
cor.cluster <- correlation_matrix_for_method(method)
col2 <- HeatmapColors()
hc <- hclust(dist(cor.cluster))
# get cluster IDs for the groups
groups <- cutree(hc, k=Ngroups)
# define colors for the Ngroups clusters
colorset <- brewer.pal(Ngroups, "Set1")
color.map <- function(cluster_id) {return(colorset[cluster_id])}
clusterColors <- unlist(lapply(groups, color.map))
# Create heatmap plot
plot_ys3_heatmap <- function(){
heatmap.2(cor.cluster, col=col2(10), scale="none",
key=TRUE, symkey=FALSE, trace="none", cexRow=0.8, cexCol=0.8,
main=method,
density.info="none", dendrogram="column", Rowv=as.dendrogram(hc), Colv=as.dendrogram(hc), keysize=0.8,
ColSideColors=clusterColors, revC=TRUE,
sepwidth=c(0.05,0.05),
sepcolor="black",
colsep=1:ncol(cor.cluster),
rowsep=1:nrow(cor.cluster))
}
# plot to file
png(filename=file.path(resultsPath, "correlation", "ys3_correlation.png"), width=2500, height=2500, res=200)
plot_ys3_heatmap()
invisible(dev.off())
# plot to report
plot_ys3_heatmap()
method <- 'ys3'
cor.cluster <- correlation_matrix_for_method(method)
col2 <- HeatmapColors()
hc <- hclust(dist(cor.cluster))
# get cluster IDs for the groups
groups <- cutree(hc, k=Ngroups)
# define colors for the Ngroups clusters
colorset <- brewer.pal(Ngroups, "Set1")
color.map <- function(cluster_id) {return(colorset[cluster_id])}
clusterColors <- unlist(lapply(groups, color.map))
# Create heatmap plot
plot_ys3_heatmap <- function(){
heatmap.2(cor.cluster, col=col2(10), scale="none",
key=TRUE, symkey=FALSE, trace="none", cexRow=0.8, cexCol=0.8,
main=method,
density.info="none", dendrogram="column", Rowv=as.dendrogram(hc), Colv=as.dendrogram(hc), keysize=0.8,
ColSideColors=clusterColors, revC=TRUE,
sepwidth=c(0.01,0.01),
sepcolor="black",
colsep=1:ncol(cor.cluster),
rowsep=1:nrow(cor.cluster))
}
# plot to file
png(filename=file.path(resultsPath, "correlation", "ys3_correlation.png"), width=2500, height=2500, res=200)
plot_ys3_heatmap()
invisible(dev.off())
# plot to report
plot_ys3_heatmap()
method <- 'ys3'
cor.cluster <- correlation_matrix_for_method(method)
col2 <- HeatmapColors()
hc <- hclust(dist(cor.cluster))
# get cluster IDs for the groups
groups <- cutree(hc, k=Ngroups)
# define colors for the Ngroups clusters
colorset <- brewer.pal(Ngroups, "Set1")
color.map <- function(cluster_id) {return(colorset[cluster_id])}
clusterColors <- unlist(lapply(groups, color.map))
# Create heatmap plot
plot_ys3_heatmap <- function(){
heatmap.2(cor.cluster, col=col2(10), scale="none",
key=TRUE, symkey=FALSE, trace="none", cexRow=0.8, cexCol=0.8,
main=method,
density.info="none", dendrogram="column", Rowv=as.dendrogram(hc), Colv=as.dendrogram(hc), keysize=0.5,
ColSideColors=clusterColors, revC=TRUE,
sepwidth=c(0.01,0.01),
sepcolor="black",
colsep=1:ncol(cor.cluster),
rowsep=1:nrow(cor.cluster))
}
# plot to file
png(filename=file.path(resultsPath, "correlation", "ys3_correlation.png"), width=2500, height=2500, res=200)
plot_ys3_heatmap()
invisible(dev.off())
# plot to report
plot_ys3_heatmap()
method <- 'ys3'
cor.cluster <- correlation_matrix_for_method(method)
col2 <- HeatmapColors()
hc <- hclust(dist(cor.cluster))
# get cluster IDs for the groups
groups <- cutree(hc, k=Ngroups)
# define colors for the Ngroups clusters
colorset <- brewer.pal(Ngroups, "Set1")
color.map <- function(cluster_id) {return(colorset[cluster_id])}
clusterColors <- unlist(lapply(groups, color.map))
# Create heatmap plot
plot_ys3_heatmap <- function(){
heatmap.2(cor.cluster, col=col2(10), scale="none",
key=TRUE, symkey=FALSE, trace="none", cexRow=0.8, cexCol=0.8,
main=method,
density.info="none", dendrogram="column", Rowv=as.dendrogram(hc), Colv=as.dendrogram(hc), keysize=0.5,
ColSideColors=clusterColors, revC=TRUE,
sepwidth=c(0.01,0.01),
sepcolor="black",
colsep=1:ncol(cor.cluster),
rowsep=1:nrow(cor.cluster))
}
# plot to file
png(filename=file.path(resultsPath, "correlation", "ys3_correlation.png"), width=2500, height=2500, res=200)
plot_ys3_heatmap()
invisible(dev.off())
# plot to report
plot_ys3_heatmap()
method <- 'ys3'
cor.cluster <- correlation_matrix_for_method(method)
col2 <- HeatmapColors()
hc <- hclust(dist(cor.cluster))
# get cluster IDs for the groups
groups <- cutree(hc, k=Ngroups)
# define colors for the Ngroups clusters
colorset <- brewer.pal(Ngroups, "Set1")
color.map <- function(cluster_id) {return(colorset[cluster_id])}
clusterColors <- unlist(lapply(groups, color.map))
# Create heatmap plot
plot_ys3_heatmap <- function(){
heatmap.2(cor.cluster, col=col2(10), scale="none",
key=TRUE, symkey=FALSE, trace="none", cexRow=0.8, cexCol=0.8,
main=method,
density.info="none", dendrogram="column", Rowv=as.dendrogram(hc), Colv=as.dendrogram(hc), keysize=0.6,
ColSideColors=clusterColors, revC=TRUE,
sepwidth=c(0.01,0.01),
sepcolor="black",
colsep=1:ncol(cor.cluster),
rowsep=1:nrow(cor.cluster))
}
# plot to file
png(filename=file.path(resultsPath, "correlation", "ys3_correlation.png"), width=2500, height=2500, res=200)
plot_ys3_heatmap()
invisible(dev.off())
# plot to report
plot_ys3_heatmap()
method <- 'ys3'
cor.cluster <- correlation_matrix_for_method(method)
col2 <- HeatmapColors()
hc <- hclust(dist(cor.cluster))
# get cluster IDs for the groups
groups <- cutree(hc, k=Ngroups)
# define colors for the Ngroups clusters
colorset <- brewer.pal(Ngroups, "Set1")
color.map <- function(cluster_id) {return(colorset[cluster_id])}
clusterColors <- unlist(lapply(groups, color.map))
# Create heatmap plot
plot_ys3_heatmap <- function(){
heatmap.2(cor.cluster, col=col2(10), scale="none",
key=TRUE, symkey=FALSE, trace="none", cexRow=0.8, cexCol=0.8,
main=method,
density.info="none", dendrogram="column", Rowv=as.dendrogram(hc), Colv=as.dendrogram(hc), keysize=0.6,
ColSideColors=clusterColors, revC=TRUE,
sepwidth=c(0.01,0.01),
sepcolor="black",
colsep=1:ncol(cor.cluster),
rowsep=1:nrow(cor.cluster))
}
# plot to file
png(filename=file.path(resultsPath, "correlation", "ys3_correlation.png"), width=2500, height=2500, res=200)
plot_ys3_heatmap()
invisible(dev.off())
# plot to report
plot_ys3_heatmap()
dev.off()
method <- 'ys3'
cor.cluster <- correlation_matrix_for_method(method)
col2 <- HeatmapColors()
hc <- hclust(dist(cor.cluster))
# get cluster IDs for the groups
groups <- cutree(hc, k=Ngroups)
# define colors for the Ngroups clusters
colorset <- brewer.pal(Ngroups, "Set1")
color.map <- function(cluster_id) {return(colorset[cluster_id])}
clusterColors <- unlist(lapply(groups, color.map))
# Create heatmap plot
plot_ys3_heatmap <- function(){
heatmap.2(cor.cluster, col=col2(10), scale="none",
key=TRUE, symkey=FALSE, trace="none", cexRow=0.8, cexCol=0.8,
main=method,
density.info="none", dendrogram="column", Rowv=as.dendrogram(hc), Colv=as.dendrogram(hc), keysize=0.6,
ColSideColors=clusterColors, revC=TRUE,
sepwidth=c(0.01,0.01),
sepcolor="black",
colsep=1:ncol(cor.cluster),
rowsep=1:nrow(cor.cluster))
}
# plot to file
png(filename=file.path(resultsPath, "correlation", "ys3_correlation.png"), width=2500, height=2500, res=200)
plot_ys3_heatmap()
invisible(dev.off())
# plot to report
plot_ys3_heatmap()
method <- 'ys3'
cor.cluster <- correlation_matrix_for_method(method)
col2 <- HeatmapColors()
hc <- hclust(dist(cor.cluster))
# get cluster IDs for the groups
groups <- cutree(hc, k=Ngroups)
# define colors for the Ngroups clusters
colorset <- brewer.pal(Ngroups, "Set1")
color.map <- function(cluster_id) {return(colorset[cluster_id])}
clusterColors <- unlist(lapply(groups, color.map))
# Create heatmap plot
plot_ys3_heatmap <- function(){
heatmap.2(cor.cluster, col=col2(10), scale="none",
key=TRUE, symkey=FALSE, trace="none", cexRow=0.8, cexCol=0.8,
main=method,
density.info="none", dendrogram="column", Rowv=as.dendrogram(hc), Colv=as.dendrogram(hc), keysize=0.8,
ColSideColors=clusterColors, revC=TRUE,
sepwidth=c(0.01,0.01),
sepcolor="black",
colsep=1:ncol(cor.cluster),
rowsep=1:nrow(cor.cluster))
}
# plot to file
png(filename=file.path(resultsPath, "correlation", "ys3_correlation.png"), width=2500, height=2500, res=200)
plot_ys3_heatmap()
invisible(dev.off())
# plot to report
plot_ys3_heatmap()
dev.off()
method <- 'ys3'
cor.cluster <- correlation_matrix_for_method(method)
col2 <- HeatmapColors()
hc <- hclust(dist(cor.cluster))
# get cluster IDs for the groups
groups <- cutree(hc, k=Ngroups)
# define colors for the Ngroups clusters
colorset <- brewer.pal(Ngroups, "Set1")
color.map <- function(cluster_id) {return(colorset[cluster_id])}
clusterColors <- unlist(lapply(groups, color.map))
# Create heatmap plot
plot_ys3_heatmap <- function(){
heatmap.2(cor.cluster, col=col2(10), scale="none",
key=TRUE, symkey=FALSE, trace="none", cexRow=0.8, cexCol=0.8,
main=method,
density.info="none", dendrogram="column", Rowv=as.dendrogram(hc), Colv=as.dendrogram(hc), keysize=0.8,
ColSideColors=clusterColors, revC=TRUE,
sepwidth=c(0.01,0.01),
sepcolor="black",
colsep=1:ncol(cor.cluster),
rowsep=1:nrow(cor.cluster))
}
# plot to file
png(filename=file.path(resultsPath, "correlation", "ys3_correlation.png"), width=2500, height=2500, res=200)
plot_ys3_heatmap()
invisible(dev.off())
# plot to report
plot_ys3_heatmap()
method <- 'ys3'
cor.cluster <- correlation_matrix_for_method(method)
col2 <- HeatmapColors()
hc <- hclust(dist(cor.cluster))
# get cluster IDs for the groups
groups <- cutree(hc, k=Ngroups)
# define colors for the Ngroups clusters
colorset <- brewer.pal(Ngroups, "Set1")
color.map <- function(cluster_id) {return(colorset[cluster_id])}
clusterColors <- unlist(lapply(groups, color.map))
# Create heatmap plot
plot_ys3_heatmap <- function(){
heatmap.2(cor.cluster, col=col2(10), scale="none",
key=TRUE, symkey=FALSE, trace="none", cexRow=0.8, cexCol=0.8,
main=method,
density.info="none", dendrogram="column", Rowv=as.dendrogram(hc), Colv=as.dendrogram(hc), keysize=0.8,
key.xlab = "ys3 correlation"
ColSideColors=clusterColors, revC=TRUE,
sepwidth=c(0.01,0.01),
sepcolor="black",
colsep=1:ncol(cor.cluster),
rowsep=1:nrow(cor.cluster))
}
# plot to file
png(filename=file.path(resultsPath, "correlation", "ys3_correlation.png"), width=2500, height=2500, res=200)
plot_ys3_heatmap()
invisible(dev.off())
# plot to report
plot_ys3_heatmap()
method <- 'ys3'
cor.cluster <- correlation_matrix_for_method(method)
col2 <- HeatmapColors()
hc <- hclust(dist(cor.cluster))
# get cluster IDs for the groups
groups <- cutree(hc, k=Ngroups)
# define colors for the Ngroups clusters
colorset <- brewer.pal(Ngroups, "Set1")
color.map <- function(cluster_id) {return(colorset[cluster_id])}
clusterColors <- unlist(lapply(groups, color.map))
# Create heatmap plot
plot_ys3_heatmap <- function(){
heatmap.2(cor.cluster, col=col2(10), scale="none",
key=TRUE, symkey=FALSE, trace="none", cexRow=0.8, cexCol=0.8,
main=method,
density.info="none", dendrogram="column", Rowv=as.dendrogram(hc), Colv=as.dendrogram(hc), keysize=0.8,
key.xlab = "ys3 correlation",
ColSideColors=clusterColors, revC=TRUE,
sepwidth=c(0.01,0.01),
sepcolor="black",
colsep=1:ncol(cor.cluster),
rowsep=1:nrow(cor.cluster))
}
# plot to file
png(filename=file.path(resultsPath, "correlation", "ys3_correlation.png"), width=2500, height=2500, res=200)
plot_ys3_heatmap()
invisible(dev.off())
# plot to report
plot_ys3_heatmap()
plot(type="n")
plot(NA, NA, type="n")
paste("c", 1:6, sep="")
legend("topright", legend=paste("c", 1:6, sep=""), col=clusterColors)
legend("topright", legend=paste("c", 1:6, sep=""), col=clusterColors)
legend("topright", legend=paste("c", 1:6, sep=""), col=clusterColors, pch=15)
legend("topright", legend=paste("c", 1:6, sep=""), col= unlist(lapply(1:6, color.map)), pch=15)
plot_ys3_heatmap()
legend("left", legend=paste("c", 1:6, sep=""), col= unlist(lapply(1:6, color.map)), pch=15)
legend("left", legend=paste("c", 1:6, sep=""), col= unlist(lapply(1:6, color.map)), pch=15, bty="n")
plot_ys3_heatmap()
legend("left", legend=paste("c", 1:6, sep=""), col= unlist(lapply(1:6, color.map)), pch=15, bty="n")
method <- 'ys3'
cor.cluster <- correlation_matrix_for_method(method)
col2 <- HeatmapColors()
hc <- hclust(dist(cor.cluster))
# get cluster IDs for the groups
groups <- cutree(hc, k=Ngroups)
# define colors for the Ngroups clusters
colorset <- brewer.pal(Ngroups, "Set1")
color.map <- function(cluster_id) {return(colorset[cluster_id])}
clusterColors <- unlist(lapply(groups, color.map))
# Create heatmap plot
plot_ys3_heatmap <- function(){
heatmap.2(cor.cluster, col=col2(10), scale="none",
key=TRUE, symkey=FALSE, trace="none", cexRow=0.8, cexCol=0.8,
main=method,
density.info="none", dendrogram="column", Rowv=as.dendrogram(hc), Colv=as.dendrogram(hc), keysize=0.8,
key.xlab = "ys3 correlation",
ColSideColors=clusterColors, revC=TRUE,
sepwidth=c(0.01,0.01),
sepcolor="black",
colsep=1:ncol(cor.cluster),
rowsep=1:nrow(cor.cluster))
legend("left", legend=paste("c", 1:6, sep=""), col= unlist(lapply(1:6, color.map)), pch=15, bty="n")
}
# plot to file
png(filename=file.path(resultsPath, "correlation", "ys3_correlation.png"), width=2500, height=2500, res=200)
plot_ys3_heatmap()
invisible(dev.off())
# plot to report
plot_ys3_heatmap()
# plot the cluster legend
plot(NA, NA, type="n")
print(t(hist_data))
print(t(round(hist_data, digits=2)))
