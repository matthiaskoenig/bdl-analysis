Actb.x=BDLdata$Actb.x,
Actb.y=BDLdata$Actb.y), method="spearman")
actb.pearson <- cor(data.frame(Actb=BDLdata$Actb,
Actb.x=BDLdata$Actb.x,
Actb.y=BDLdata$Actb.y), method="pearson")
round(actb.pearson, digits=3)
levels(BDLfactors$ftype)
grepl("^GE_", levels(BDLfactors$ftype)
)
BDLfactors$ftype[grepl("^GE_", levels(BDLfactors$ftype)]
BDLfactors$ftype[grepl("^GE_", levels(BDLfactors$ftype))]
devtools::load_all(".")
library(BDLanalysis)
plot_single("Nos2")
plot_single("Cyp1a2")
plot_single("Cyp2c29")
plot_single("Cyp1a2")
levels(BDLfactors$ftype)
BDLfactors
BDLmean.time
levels(BDLsamples$time_fac)
library("RColorBrewer")
col2 <- HeatmapColors()
# define colors for the time point groups
Ngroups <- 8
colorset <- brewer.pal(Ngroups, "Set1")
color.map <- function(cluster_id) {return(colorset[cluster_id])}
clusterColors <- unlist(lapply(groups, color.map))
colors <- HeatmapColors()
heatmap.2(t(as.matrix(BDLdata)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8)
paste(BDLsamples$time_fac rownames(BDLsamples), sep=" ")
paste(BDLsamples$time_fac, rownames(BDLsamples), sep=" ")
paste(rownames(BDLsamples), BDLsamples$time_fac, sep=" ")
dtmp <- BDLdata
rownames(dtmp) <- paste(rownames(BDLsamples), BDLsamples$time_fac, sep=" ")
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8)
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8,  add.expr = abline(h=5, v=2))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8,  add.expr = abline(h=5.5))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8,  add.expr = abline(v=5))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8,  add.expr = abline(v=5.5))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8,  add.expr = abline(v=c(5.5, 10.5))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8,  add.expr = abline(v=5.5, v=10.5))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8,  add.expr = abline(v=5.5, h=10.5))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8,
add.expr = abline(v=5.5),
add.expr = abline(v=5.5))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8,
add.expr = abline(v=c(5.5,10.5)))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8,
add.expr = abline(v=((1:5)*5+0.5) ))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8,
add.expr=abline(v=((1:5)*8+0.5) ))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8,
add.expr=abline(v=((1:8)*5+0.5) ))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8,
add.expr=abline(v=((1:8)*5+0.5), h=47.5 ))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8,
add.expr=abline(v=((1:8)*5+0.5), col=grey ))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8,
add.expr=abline(v=((1:8)*5+0.5), col=darkgrey ))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8,
add.expr=abline(v=((1:8)*5+0.5), col=black, lwd=0.5 ))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8,
add.expr=abline(v=((1:8)*5+0.5), col="black"", lwd=0.5 ))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8,
add.expr=abline(v=((1:8)*5+0.5), col="black", lwd=0.5 ))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8,
add.expr=abline(v=((1:8)*5+0.5), col="black", lwd=0.5 ))
table(BDLfactors$ftype)
f_table <- table(BDLfactors$ftype)
f_table
f_table$Antibodies
f_table[Antibodies]
f_table["Antibodies"]
f_table[["Antibodies"]]
v_lines <- ((1:8)*5+0.5)
f_table[["Antibodies"]]
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8,
add.expr=abline(v=v_lines, col="black", lwd=0.5 ))
f_table[["Antibodies"]]
cumsum(f_table)
cumsum(f_table["Antibodies", "Histology", "Biochemistry", "GE_Fibrosis", "GE_Cytokines", "GE_ADME"])
cumsum(f_table["Antibodies", "Histology", "Biochemistry", "GE_Fibrosis", "GE_Cytokines", "GE_ADME"]))
f_table["Antibodies", "Histology", "Biochemistry", "GE_Fibrosis", "GE_Cytokines", "GE_ADME"]
f_table[c("Antibodies", "Histology", "Biochemistry", "GE_Fibrosis", "GE_Cytokines", "GE_ADME")]
cumsum(f_table[c("Antibodies", "Histology", "Biochemistry", "GE_Fibrosis", "GE_Cytokines", "GE_ADME")])
f_table <- table(BDLfactors$ftype)
h_lines <- cumsum(f_table[c("Antibodies", "Histology", "Biochemistry", "GE_Fibrosis", "GE_Cytokines", "GE_ADME")])
h_lines
f_table <- table(BDLfactors$ftype)
h_lines <- 0.5 + cumsum(f_table[c("Antibodies", "Histology", "Biochemistry", "GE_Fibrosis", "GE_Cytokines", "GE_ADME")])
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8,
add.expr=abline(v=v_lines, h=h_lines, col="black", lwd=0.5 ))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8, density.info="none",
add.expr=abline(v=v_lines, h=h_lines, col="black", lwd=0.5 ))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", dendrogram="none", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8, density.info="none",
add.expr=abline(v=v_lines, h=h_lines, col="black", lwd=0.5 ))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", dendrogram="none", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8, density.info="none",
add.expr=abline(v=v_lines, h=h_lines, col="black", lwd=0.5 ),
main="Heatmap of BDL time course data",
xlab="sample",
ylab="factor")
f_types <- c("Antibodies", "Histology", "Biochemistry", "GE_Fibrosis", "GE_Cytokines", "GE_ADME")
f_table <- table(BDLfactors$ftype)
h_lines <- 0.5 + cumsum(f_table[f_types])
colorset <- brewer.pal(Ngroups, "Set2")
Ngroups <- length(f_types)
colorset <- brewer.pal(length(f_types), "Set2")
color.map <- function(factor_id) {return(which(f_types==BDLfactors[factor_id]$ftype))}
factorColors <- unlist(lapply(colnames(BDLdata), color.map))
color.map <- function(factor_id) {return(which(f_types==BDLfactors[factor_id]$ftype))}
color.map('Ppara')
BDLfactors["Ppara"]$ftype)
BDLfactors["Ppara"]$ftype
BDLfactors$ftype["Ppara"]
BDLfactors$ftype
BDLfactors$ftype
BDLfactors$ftype[rownames(BDLdata)]
rownames(BDLdata)
rownames(BDLfactors)
text(x=-2, y=h_lines, labels=f_types)
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", dendrogram="none", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8, density.info="none",
add.expr=abline(v=v_lines, h=h_lines, col="black", lwd=0.5 ),
main="Heatmap of BDL time course data",
xlab="sample",
ylab="factor")
text(x=-2, y=h_lines, labels=f_types)
text(x=2, y=h_lines, labels=f_types)
text(x=2, y=2, labels=f_types)
text(x=-2, y=2, labels=f_types)
text(x=0, y=2, labels=f_types)
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", dendrogram="none", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8, density.info="none",
add.expr=abline(v=v_lines, h=h_lines, col="black", lwd=0.5 ),
main="Heatmap of BDL time course data",
xlab="sample",
ylab="factor")
text(x=0, y=0, labels=f_types)
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", dendrogram="none", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8, density.info="none",
add.expr=abline(v=v_lines, h=h_lines, col="black", lwd=0.5 ),
main="Heatmap of BDL time course data",
xlab="sample",
ylab="factor")
par(lend = 1)           # square line ends for the color legend
legend("topright",      # location of the legend on the heatmap plot
legend = f_types, # category labels
col = colorset,  # color key
lty= 1,             # line style
lwd = 10            # line width
)
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", dendrogram="none", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8, density.info="none",
add.expr=abline(v=v_lines, h=h_lines, col="black", lwd=0.5 ),
main="Heatmap of BDL time course data",
xlab="sample",
ylab="factor")
par(lend = 1)           # square line ends for the color legend
legend("topright",      # location of the legend on the heatmap plot
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10            # line width
)
legend("topright",      # location of the legend on the heatmap plot
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.8
)
legend("topleft",      # location of the legend on the heatmap plot
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.8
)
legend("topleft",      # location of the legend on the heatmap plot
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.8,
bty="n"
)
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", dendrogram="none", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8, density.info="none",
add.expr=abline(v=v_lines, h=h_lines, col="black", lwd=0.5 ),
main="Heatmap of BDL time course data",
xlab="sample",
ylab="factor")
par(lend = 1)           # square line ends for the color legend
legend("topleft",      # location of the legend on the heatmap plot
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.8,
bty="n"
)
par(lend = 1)           # square line ends for the color legend
legend("topleft",      # location of the legend on the heatmap plot
inset=c(-0.2,0),
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.8,
bty="n"
)
legend("topleft",      # location of the legend on the heatmap plot
inset=c(-2.0,0),
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.8,
bty="n"
)
legend("topleft",      # location of the legend on the heatmap plot
inset=c(0.3,0),
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.8,
bty="n"
)
legend("topleft",      # location of the legend on the heatmap plot
inset=c(-0.01,0),
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.8,
bty="n"
)
legend("topleft",      # location of the legend on the heatmap plot
inset=c(-0.05,0),
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.8,
bty="n"
)
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", dendrogram="none", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8, density.info="none",
add.expr=abline(v=v_lines, h=h_lines, col="black", lwd=0.5 ),
main="Heatmap of BDL time course data",
xlab="sample",
ylab="factor")
par(lend = 1)           # square line ends for the color legend
legend("topleft",      # location of the legend on the heatmap plot
inset=c(-0.03,0),
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.8,
bty="n"
)
legend("topright",      # location of the legend on the heatmap plot
inset=c(+0.05,0),
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.8,
bty="n"
)
legend("topright",      # location of the legend on the heatmap plot
inset=c(0,0.05),
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.8,
bty="n"
)
legend("topright",      # location of the legend on the heatmap plot
inset=c(0,-0.1),
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.8,
bty="n"
)
legend("topleft",      # location of the legend on the heatmap plot
inset=c(-0.04,0),
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.8,
bty="n"
)
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", dendrogram="none", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8, density.info="none",
add.expr=abline(v=v_lines, h=h_lines, col="black", lwd=0.5 ),
main="Heatmap of BDL time course data",
xlab="sample",
ylab="factor", margin=c(5,5))
par(lend = 1)           # square line ends for the color legend
legend("topleft",      # location of the legend on the heatmap plot
inset=c(-0.04,0),
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.8,
bty="n"
)
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", dendrogram="none", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8, density.info="none",
add.expr=abline(v=v_lines, h=h_lines, col="black", lwd=0.5 ),
main="Heatmap of BDL time course data",
xlab="sample",
ylab="factor", margin=c(7,5))
par(lend = 1)           # square line ends for the color legend
legend("topleft",      # location of the legend on the heatmap plot
inset=c(-0.04,0),
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.8,
bty="n"
)
colorset <- data.frame(f_type=f_types, brewer.pal(length(f_types), "Set2")
colorset <- data.frame(f_type=f_types, brewer.pal(length(f_types), "Set2")
colorset <- data.frame(f_types, brewer.pal(length(f_types), "Set2")
colorset <- data.frame(f_types, brewer.pal(length(f_types), "Set2"))
colorset <- brewer.pal(length(f_types), "Set2"))
colorset <- brewer.pal(length(f_types), "Set2")
colorset
which(f_types==BDLfactors$ftype)
which(f_types==BDLfactors$ftype[1])
color.map <- function(factor_id) {return(colorset[which(f_types==BDLfactors$ftype[cluster_id]])}
color.map <- function(factor_id) {return(colorset[ which(f_types==BDLfactors$ftype[cluster_id]) ]}
color.map <- function(factor_id) {return(colorset[ which(f_types==BDLfactors$ftype[cluster_id]) ])}
clusterColors <- unlist(lapply(BDLfactors$ftype, color.map))
color.map <- function(factor_id) {return(colorset[ which(f_types==BDLfactors$ftype[factor_id]) ])}
clusterColors <- unlist(lapply(BDLfactors$ftype, color.map))
factorColors <- unlist(lapply(BDLfactors$ftype, color.map))
# define colors for type of experimentell data, i.e. factor groups
colorset <- brewer.pal(length(f_types), "Set2")
color.map <- function(factor_id) {return(colorset[ which(f_types==BDLfactors$ftype[factor_id]) ])}
factorColors <- unlist(lapply(BDLfactors$ftype, color.map))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", dendrogram="none", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8, density.info="none",
RowSideColors=factorColors,
add.expr=abline(v=v_lines, h=h_lines, col="black", lwd=0.5),
main="Heatmap of BDL time course data",
xlab="sample",
ylab="factor")
factorColors
color.map <- function(factor_id) {return(colorset[ which(f_types==BDLfactors$ftype[factor_id]) ])}
factorColors <- unlist(lapply(BDLfactors$ftype, color.map))
factorColors
colorset <- brewer.pal(length(f_types), "Set2")
colorset
f_types==BDLfactors$ftype["Ppara"])
f_types==BDLfactors$ftype["Ppara"]
BDLfactors$ftype["Ppara"]
BDLfactors$ftype
BDLfactors$id["Ppara"]
BDLfactors
which(BDLfactors$id=="Ppara")
color.map <- function(factor_id) {return(colorset[ which(f_types==BDLfactors$ftype[which(BDLfactors$id==factor_id)]) ])}
factorColors <- unlist(lapply(BDLfactors$ftype, color.map))
color.map <- function(factor_id) {return(colorset[ which(f_types==BDLfactors$ftype[which(BDLfactors$id==factor_id)]) ])}
color.map('Ppara')
colorset
f_types
color.map <- function(factor_id) {return(colorset[ which(f_types==BDLfactors$ftype[which(BDLfactors$id==factor_id)]) ])}
factorColors <- unlist(lapply(BDLfactors$id, color.map))
factorColors
# define colors for type of experimentell data, i.e. factor groups
colorset <- brewer.pal(length(f_types), "Set2")
color.map <- function(factor_id) {return(colorset[ which(f_types==BDLfactors$ftype[which(BDLfactors$id==factor_id)]) ])}
factorColors <- unlist(lapply(BDLfactors$id, color.map))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", dendrogram="none", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8, density.info="none",
RowSideColors=factorColors,
add.expr=abline(v=v_lines, h=h_lines, col="black", lwd=0.5),
main="Heatmap of BDL time course data",
xlab="sample",
ylab="factor")
legend("topleft",      # location of the legend on the heatmap plot
inset=c(-0.04,0),
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.5,
bty="n"
)
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", dendrogram="none", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8, density.info="none",
RowSideColors=factorColors,
add.expr=abline(v=v_lines, h=h_lines, col="black", lwd=0.5),
main="Heatmap of BDL time course data",
xlab="sample",
ylab="factor")
legend("topleft",      # location of the legend on the heatmap plot
inset=c(0,0),
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.7,
bty="n"
)
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", dendrogram="none", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8, density.info="none",
RowSideColors=factorColors,
add.expr=abline(v=v_lines, h=h_lines, col="black", lwd=0.5),
main="Heatmap of BDL time course data",
xlab="sample",
ylab="factor")
legend("topleft",      # location of the legend on the heatmap plot
inset=c(-0.02,0),
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.7,
bty="n"
)
colorset <- brewer.pal(length(f_types), "Set3")
color.map <- function(factor_id) {return(colorset[ which(f_types==BDLfactors$ftype[which(BDLfactors$id==factor_id)]) ])}
factorColors <- unlist(lapply(BDLfactors$id, color.map))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", dendrogram="none", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8, density.info="none",
RowSideColors=factorColors,
add.expr=abline(v=v_lines, h=h_lines, col="black", lwd=0.5),
main="Heatmap of BDL time course data",
xlab="sample",
ylab="factor")
legend("topleft",      # location of the legend on the heatmap plot
inset=c(-0.02,0),
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.7,
bty="n"
)
colorset <- brewer.pal(length(f_types), "Set2")
color.map <- function(factor_id) {return(colorset[ which(f_types==BDLfactors$ftype[which(BDLfactors$id==factor_id)]) ])}
factorColors <- unlist(lapply(BDLfactors$id, color.map))
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", dendrogram="none", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8, density.info="none",
RowSideColors=factorColors,
add.expr=abline(v=v_lines, h=h_lines, col="black", lwd=0.5),
main="Heatmap of BDL time course data",
xlab="sample",
ylab="factor")
legend("topleft",      # location of the legend on the heatmap plot
inset=c(-0.02,0),
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.7,
bty="n"
)
heatmap.2(t(as.matrix(dtmp)), col=colors(100), scale="row", dendrogram="none", Rowv=NULL, Colv=NULL,
key=TRUE, trace="none", cexRow=0.5, keysize=0.8, density.info="none",
RowSideColors=factorColors,
add.expr=abline(v=v_lines, h=h_lines, col="black", lwd=0.5),
main="Heatmap of BDL time course data")
# xlab="sample", ylab="factor")
legend("topleft",      # location of the legend on the heatmap plot
inset=c(-0.02,0),
legend = rev(f_types), # category labels
col = rev(colorset),  # color key
lty= 1,             # line style
lwd = 10,            # line width
cex = 0.7,
bty="n"
)
